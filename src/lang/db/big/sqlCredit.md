# 信贷全生命周期监控报表开发



## 报表的作用及设计出发点

### 监控报表的作用有三点

①是直观反应历史及现阶段的业务状况；
②是能及时发现问题，并帮助我们从多个角度来分析优化；
③是可以反应用户及资产的整个[生命周期](https://so.csdn.net/so/search?q=生命周期&spm=1001.2101.3001.7020)情况，为业务的未来发展方向提供指导意见



## 报表的设计

文章会从贷前，贷中，贷后三个环节依次来讲解报表的设计

贷前：新客的授信和支用环节
贷中：老客的支用环节，额度管理环节，以及新老客放款后的到期逾期情况
贷后：新老客进入逾期阶段的催收环节





### 第一模块.贷前环节

贷前报表的作用主要是新客授信和支用的审批监控。

#### 1.授信通过率监控报表

1）作用：来监控新进用户的授信通过情况和额度情况。
2）指标及计算口径：
授信通过率 = 授信通过人数 / 授信申请人数
平均授信额度 = 总授信额度 / 授信通过人数
3）维度：申请时间(天/周/月)，拉新渠道，用户类型
4）报表展示：
![在这里插入图片描述](https://img-blog.csdnimg.cn/5498817d05dd4789bb0d8763c8452fad.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA55Wq6IyE6aOO5o6n,size_19,color_FFFFFF,t_70,g_se,x_16)
5）分析角度：授信通过率和平均额度的高低能反应新客的质量，像优质渠道的通过率和额度都会比较高，另外也需要关注每天的申请人数，能反应渠道拉新的情况，以及业务对新客运营的策略方向。

#### 2.授信规则监控报表

1）作用：监控授信审批的通过情况，对发现异常和调整策略提供依据。
2）指标及计算口径：
拒绝率 = 规则拒绝人数 / 规则触发人数
3）维度：申请时间(天/周/月)
4）报表展示：
![在这里插入图片描述](https://img-blog.csdnimg.cn/61693477128e4be892efa53b1bc0dbe4.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA55Wq6IyE6aOO5o6n,size_12,color_FFFFFF,t_70,g_se,x_16)
5）分析角度：拒绝率能反映规则对于风控决策的权重，也能反映客群在某些方面的变化情况，例如多头规则的拒绝率显著上升，说明用户多头借贷的情况在加重，需要提高警惕。

#### 3.三方调用情况监控报表

1）作用：及时发现三方调用异常，保证风控系统正常运行。
2）指标及计算口径：
三方调用成功率 = 三方调用成功次数/ 三方调用次数
三方调用成本 = 三方单笔调用价格*调用成功次数(或者命中次数）
3）维度：申请时间(天/周/月)，三方数据名称，授信/支用
4）报表展示：
![在这里插入图片描述](https://img-blog.csdnimg.cn/eab690145beb4f119f3edf043fb01c45.png)
5）分析角度：三方调用成功率正常情况是100%，如果低于100%，说明三方调用出现问题，此时应及时跟负责三方接口的开发反馈问题并解决，保障风控系统的正常运行，另外也可关注每天三方调用的成本是否正常，例如黑名单是命中才收费，如果成本一下子升很高，可能是数据或者命中逻辑出现问题。

#### 4.支用通过率监控报表

1）作用：跟授信通过类似，来监控支用环节的通过率和支用金额的情况
2）指标及计算口径：
支用通过率 = 支用通过订单 / 支用申请订单
平均支用额度 = 总支用金额 / 支用通过订单
(授信通过用的是人维度，因为一个用户一天只能被授信一次，而授信通过后，用户在额度范围内，一天可支用多笔订单，所以支用通过用的是订单维度）
3）维度：申请时间(天/周/月)，用户类型
4）报表展示：
![在这里插入图片描述](https://img-blog.csdnimg.cn/d1dbab933f5043dfa05ec00f4c6cfd22.png)

5）分析角度：支用通过率过低说明客群质量不佳，过高可能存在团体包装申请资料的风险。平均支用金额跟授信额度关联可计算新客首单的额度使用率，对于优质用户而言，一般是需要多少钱支用多少钱，而对于欺诈用户可能一次性就把额度用光，可分析下申请额度金额跟逾期率的关系。另外对于申请量，某天突然起量时要关注欺诈团伙集中申请的风险，量明显萎缩时，也要分析原因，是不是策略上做了什么调整。

#### 5.支用规则监控报表

1）作用：监控支用审批的通过情况，对发现异常和调整策略提供依据
2）指标及计算口径：
拒绝率 = 规则拒绝订单数 / 规则触发订单数
3）维度：申请时间(天/周/月)，规则分类
4）报表展示：
![在这里插入图片描述](https://img-blog.csdnimg.cn/509a12cdbcf34b00a0818b90680ee49b.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA55Wq6IyE6aOO5o6n,size_12,color_FFFFFF,t_70,g_se,x_16)

5）分析角度：如果支用通过率很低，需要从规则角度来分析，先看是哪一类规则拒绝率明显升高，再看是哪一条规则起的作用很大，针对这条规则来看是否可以做一些放松。



#### 6.各环节转化率漏斗

每天多少人注册、申请、通过、放款、还款

![img](https://pic1.zhimg.com/80/v2-7c856f6eddcfb4b7a0778b524c83ded8_720w.webp)

## 第二模块.贷中环节

贷中环节涉及到的场景比较多，这里我们将报表分为以下几类：
1）额度/费率/期限管理，包括提额，降额，费率/期限调整等场景
2）老客收益维度管理，包括支用提现，复借，留存等场景
3）新老客的风险管理，包括出账逾期监控，逾期滚动，迁移
4）用户行为监控，包括申请行为，在贷行为，被拒行为，模型分等
5）老客的支用环节，包括支用通过，规则拒绝监控等

### 1.额度/费率/期限管理

额度/费率/期限管理是贷中对于老客常见的运用手段。
针对好用户，可以对其提高额度来激励支用，或者通过降低费率的方式，尤其对于低额度使用率的用户，对提升额度不敏感，但降低费率可刺激其使用额度，也可增加期限选项，对好用户放开短期的借款，提供更多的借款选择。
针对坏用户，降低额度是比较有效的手段，一方面是为了减少坏账损失，同时也可以提醒用户注意自己的信用资质，另外费率的提升也能覆盖未来一部分的坏账损失。

#### 1.提额通过率监控报表

1）作用：监控提额的通过率和提升的额度情况
2）指标及计算口径：
提额通过率：提额通过人数 / 提额申请人数
提额平均额度：提额总额度 / 提额通过人数
3）维度：申请时间(天/周/月)，认证方式，用户类型
4）报表展示：
![在这里插入图片描述](https://img-blog.csdnimg.cn/91e25c50ec684db5a2d6a492ff15508d.png)

5）分析角度：目前常见的提额方式有社保提额，公积金提额，学历提额，信用提额，我们要关注每种提额的通过情况。提额的平均额度或者通过率突然升高，要警惕是不是有一些用户利用规则漏洞在刷额度。

#### 1.2.提额后的逾期监控报表

1）作用：比较提额成功VS提额失败的逾期表现，观察提额后坏账的情况
2）指标及计算口径
PD指标(人维度) 或者 前N期最大逾期天数N+用户占比
这里先介绍下PD指标，例如FPD1，SPD7，TPD30等，前面的字母代表第几期，F代表第一期，S代表第二期，T代表第三期…，后面的数字指的是逾期天数，如果用户存在好几笔账单，则这个数字代表最大逾期天数，例如FPD7，代表用户第一期最大逾期天数>=7天的逾期率。如果用户身上有FPD30的标记，那必定有FPD7，FPD15的标记，考虑到催收的影响，FPD0，FPD7，FPD15，FPD30是逐渐降低的。另外由于信贷产品要还完前一期然后才能还下一期，用户越到后面，风险暴露的越彻底，所以FPD7，SPD7，TPD7是逐渐升高的。
在看提额后的逾期表现时，我们通常将逾期算在人维度，也就是逾期用户占比。
例：首期逾期15+用户占比（FPD15） = 首期发生过逾期15+的用户数 / 首期已出账15+用户数（这里已出账15+的意思是首期到期了15天以上，因为我们定义逾期天数是15+，所以出账的表现期要在15天以上）
3）维度：到期天/周/月，到期的期数，提额成功VS提额失败
4）报表展示：
![在这里插入图片描述](https://img-blog.csdnimg.cn/95d03f4edbdf4517bd249ed06fb989bc.png)
5）分析角度：一般来说提额成功的用户比提额失败的用户质量要好，在分析时可从两个角度看，一是从期数的维度出发，这时候逾期N+要统一，例如逾期15+，看提额成功的用户是不是每一期表现都比提额失败的要好。从而看出我们的提额策略是不是真的把好用户挑出来了。第二个角度就是按坏用户标准看，例如直接定义坏用户为前3期最大逾期天数15天以上，按这个标准来看提额成功VS提额失败的坏用户占比哪个高。

#### 1.3.降额后的逾期监控报表

1）作用：提额一般是用户主动发起的，而降额是用户被动的，金融机构一般会定期通过自有平台贷后表现（B卡）对用户做信用资质评估，对那些资质评估差的用户发起降额，或者触发某些降额规则，例如用户最大逾期天数超过30天发起降额，我们需要挑一批资质差的用户，分析比较降额VS不降额的逾期表现，来佐证降额策略的合理性。
2）指标及计算口径
PD指标(人维度) 或者 前N期最大逾期天数N+用户占比
3）维度：到期天/周/月，到期的期数，降额VS不降额
4）报表展示：
![在这里插入图片描述](https://img-blog.csdnimg.cn/ba7981aed28a4766981de7043569d5cb.png)

5）分析角度：降额这种手段对用户有两面性，有些用户看到额度被降会注意保护自己的信用资质，会把之前的逾期账单尽快还掉，而有些用户发现金融机构不想让自己来多借钱了，会引起他们的抵触心理，导致更加不愿意还之前的逾期账单，所以通过降额VS不降额的逾期表现的对比可分析降额策略是否合理，同理提高费率也是一样。

#### 1.4.授信额度区间的逾期监控报表

1）作用：在授信阶段，我们会根据用户的风险等级分配不同的额度，风险低且还款能力强给高额度，风险高且还款能力弱则给低额度。通过不同额度区间的逾期监控可分析授信的额度划分是否合理。
2）指标及计算口径
PD指标(人维度) 或者 前N期最大逾期天数N+用户占比
3）维度：到期天/周/月，到期的期数，授信额度区间
4）报表展示：
![在这里插入图片描述](https://img-blog.csdnimg.cn/5d4c887dd17a433b9553284a0f5195a9.png)
5）分析角度：如果我们做额度划分是更多考虑的是用户的违约风险，那授信额度高低就能反映用户的逾期表现，正常情况下额度越低，逾期率越高，如果结果跟预期差很多，可能就得重新做一套额度划分的策略了。

### 二.老客收益维度管理

对于贷中老客的管理除了风险，还有跟经营收益相关的东西，例如提高用户粘性，减少用户流失，希望老客能源源不断的给金融机构创造收益。这种场景主要关注的指标有提现率，留存率，复借率。

#### 2.1.提现率监控报表

1）作用：对于授信成功的用户，额度提现的用户占比与收益相关，如果一个用户长期不使用额度，会造成额度浪费，金融机构也会采取对其冻结额度或者降额的处理。
2）指标及计算口径
授信后N天的提现率：授信后N天内申请提现用户数 / 授信成功用户数
3）维度：授信日期(天)，用户类型
4）报表展示：
![在这里插入图片描述](https://img-blog.csdnimg.cn/dc3307e8a7bf47d0872417e5bbacfb52.png)
5）分析角度：通过授信N+提现率的滚动情况中可以看出，例如90天后提现率基本不发生变化，可以定为授信后90天用户不发生提现行为，会对其做二次授信要求或者降额处理。另外如果授信后30天内提现率太低，则需要用一些营销手段刺激用户来提现。

#### 2.2.复借率监控报表

1）作用：复借表现为用户有还款行为后，又来申请一笔的借款表现，如果还款跟借款的间隔时间很短，可能存在借新还旧的现象，用户历史上的短期复借率一直很高，说明资金紧张，应当关注他的多头借贷情况，评估下一笔的借款的逾期风险。另外复借率也能表现用户的粘性，如果长时间不复借，用户则有流失的风险。
2）指标及计算口径
还款后N天的复借率 = 还款后N天内申请支用的用户数 / 还款成功的用户数
3）维度：还款日期(天)，用户类型
4）报表展示：
![在这里插入图片描述](https://img-blog.csdnimg.cn/3dfce939f620480b84f4776539af7c30.png)
5）分析维度：重点看短期的复借率和长期的复借率，短期复借率一直在高位说明平台用户的多头借贷比较严重，在多头这块需要加以管控，防止逾期暴雷。长期的复借率一直在低位说明用户的借贷需求不够强烈，用户有流失的风险，这种情况可以针对一些资质好且复借率低的用户采取一些营销手段来刺激复借。上述提到的留存率跟复借率类似，报表的设计思路也差不多。

2.3 新老客的风险管理

贷中风险管理主要是对已出账的新老客做逾期监控，评估用户和资产的质量。

#### 2.3.1.出账逾期监控报表

1）作用：分析在当前期数下逾期N+的表现情况，因为一个账单有好几期，所以很多公司一般拿首逾（第一期逾期）作为监控的指标，如果要观察整个账单的生命周期，则要在报表的维度上加上当前期数。出账逾期监控报表会分好多维度来分析，例如新老客维度，渠道维度，用户类型维度，资产类型维度，每个维度之间还会做交叉分析，所以出账逾期报表是监控风险中最核心的报表。
2）指标及计算口径
PD指标(人维度) = 当前期数逾期N+的用户数 / 当前期数出账N+的用户数
3）维度：到期/放款的日/周/月，渠道，用户类型，资产类型
4）报表展示
![在这里插入图片描述](https://img-blog.csdnimg.cn/30aa68021f434ad5b9eeea400971a61b.png)

5）分析角度：一是按逾期N+的横向维度看，例如按照首逾指标，FPD3，FPD7，FPD15的对比，如果FPD3高，说明用户质量差或者还款提醒不到位导致，如果FPD7，FPD15高，往往是用户质量差或者催收不力导致的（一般机构都是到期前3天短信提醒还款，3天后人力进行催收），如果FPD3，FPD7，FPD15都很高，说明客户质量真的很差，催都催不回来，如果FPD3高，FPD7马上就降下来了，需尽快看下还款提醒是否出现了问题，如果FPD3还可以，但后面FPD7，FPD15基本不变，有可能是催收效果不行。第二个角度是按期数的纵向维度看，例如按照逾期15+来看，FPD15，SPD15，TPD15是逐渐升高的，如果FPD15尚可，SPD15，TPD15相比FPD15升高很快，则说明风控首期控的好，但后面几期控的不好，按照目前期数的滚动下去，整个产品周期的坏账估计会很高。

#### 2.3.2.坏账Vintage监控报表

1）作用：坏账vintage报表是以金额作为维度计算的，所以也叫做资产质量报表，它是反映资产随着时间的坏账滚动变化，可看出整个公司的总体资产分布以及未来的走向，在其他合作方来尽调时也是必看的报表之一。
2）指标及计算口径
在计算指标前坏账要定义好，例如定义逾期天数>=30天的为坏账
坏账率 = 逾期N天以上的本金 / 放款本金
3）维度：放款/到期月，渠道，用户类型，资产类型
4）报表展示：
![在这里插入图片描述](https://img-blog.csdnimg.cn/8c131ec581814348b1916f2f0acb8a1d.png)

5）分析角度：报表中的+2M代表第一期坏账率，因为这里定义了坏账为逾期天数>=30天，所以放款两个月后才能算坏账率。按放款月的纵向维度来看，例如比较18年6-12月份的表现，可以看到不管是首期，还是2期，3期，都有明显的下降趋势，说明坏账做的越来越好，对于风控策略的优化是有成效的。按照期数的横向维度来看，例如比较18年6-12月份每一期之间的翻倍情况，可以看出随着时间推移，各期之间的坏账翻倍比在不断变小，说明风控的优化对于短，中，长期的坏账控制都做的比较好。

2.4.用户行为监控
对于贷中用户的风险行为做监控，为贷中策略的调整，额度管理，利率调整等提供决策依据。

#### 1.用户申请，共债行为监控

1）作用：反映在贷中支用环节用户的多头借贷，负债等风险，一定程度上能反映申请用户的质量情况。
2）指标及计算口径
近N天平均多头次数 = 近N天总多头次数 / 申请用户数
近N天平均被拒次数 = 近N天总被拒次数 / 申请用户数
近N天平均在贷订单数 = 近N天总在贷订单数 / 申请用户数
3）维度：申请时间(日/周/月)，用户类型
4）报表展示：
![在这里插入图片描述](https://img-blog.csdnimg.cn/4f75f8a2f19748d5a3c8eb12ff078df2.png)

5）分析角度：多头和共债分为本平台和外部平台(第三方)的数据，外部多头共债如果近段时间呈升高的趋势，说明整个市场环境的多头借贷现象变的严重，这时候要考虑对多头策略进行收紧，防止高多头风险用户大量涌入。内部多头共债升高也要警惕，对于贷中的策略要做针对性的调整。

## 第三模块.贷后环节

贷后环节主要是对催收做监控，这里就简单的介绍下关于

### 催收率监控的报表

1）作用：对贷后的催收回款进行分析，从催回率的表现上反映催收的力度和用户的质量。
2）指标及计算口径
N+催回率 = 近N天催收回款的用户数 / 已出账0+且逾期0+的用户数
3）维度：到期日/周/月，用户类型
4）报表展示：
![在这里插入图片描述](https://img-blog.csdnimg.cn/515d611ff9144cdbb8b8354599fc0d18.png)

5）分析角度：由于分子是近N天催收回款的用户数，分母不变，所以比较3+催回率，7+摧回率，15+摧回率，这三个值是不断上升的。如果3+催回率就比较高，说明用户大部分是忘了还款，经过短信提醒就行，如果3+催回率比较低，7+，15+摧回率高，说明要介入人工催收才能催回来，用户的还款意愿并不高，如果3+，7+，15+摧回率都很低，且上升的不明显，说明逾期的用户质量很差，基本上催不回来。

# 信贷报表实操练习

## 1.坏账Vintage报表开发(hive sql)

数据概况：
![在这里插入图片描述](https://img-blog.csdnimg.cn/8c1e5ce99dc84f6381c2dd19753a5c3a.png)

这是一张还款计划表，包含订单id（order_id)，放款时间(loan_time）,到期时间（due_time),还款时间（repay_time)，放款本金(loan_amount)。一个订单id有多条记录(有好几期）
sql开发逻辑：第一步：报表是以放款月作为维度的，且反映资产随着时间的坏账滚动变化，所以这边先计算当前日期(后续算逾期天数要用到），并利用add_months函数算出放款时间后面的月份滚动字段，add_m2代表+2个月（因为这里坏账的定义是逾期天数>30天，所以第一期出账至少在2个月以后)。
![在这里插入图片描述](https://img-blog.csdnimg.cn/74d1a373c2ad4c528124a4eb41889cae.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA55Wq6IyE6aOO5o6n,size_14,color_FFFFFF,t_70,g_se,x_16)
第二步：对第一步的查询结果(子查询)外面套一层sql,用来计算+2M的最大逾期天数(按订单id group by计算，这里用到了over…partition…by…的用法）,且因为可能碰到2月只有28天这种情况，所以这里加了3天来保证所有月份都能表现完全。（dateadd(to_date(add_m2,‘yyyy-mm-dd’),3,‘dd’)）。
![在这里插入图片描述](https://img-blog.csdnimg.cn/dee8baac010746dd8058e41bef321fc5.png)
第三步：在第一步和第二步的计算结果上再外面嵌套一层sql，用来计算坏账率，这里限定了最大逾期天数>30天作为坏账标准，根据放款月进行groupby计算。
![在这里插入图片描述](https://img-blog.csdnimg.cn/656c8c3bf27646718f2dedf020a9078f.png)
sql开发的报表结果：
![在这里插入图片描述](https://img-blog.csdnimg.cn/00386eec951c44509ec61772c445a4e5.png)

## 2.复借率报表开发(hive sql)

数据概况：1）还款数据，包括用户id(user_id),还款日期(pay_date)，后面计算复借以还款日作为维度。这份还款数据是2021/6/1–2021/6/7的。
![在这里插入图片描述](https://img-blog.csdnimg.cn/6e1a6e530b0f473585934c94a90a71f8.png)
2）申请数据，包括用户id(user_id),申请日期(apply_date)，在计算复借率时，同个用户的复借申请时间要大于他的还款时间，还款数据是2021/6/1–2021/9/20的，报表中最大算近90天的复借率，所以要把申请时间往后推3个月以上。
![在这里插入图片描述](https://img-blog.csdnimg.cn/2adcf121762b4e9c93714d2681ee25ed.png)sql开发逻辑：
第一步：将两张表用user_id进行关联，并限制申请时间>还款时间，计算申请时间与还款时间的间隔天数，当关联后申请时间为空时，用当前时间代替计算。
![在这里插入图片描述](https://img-blog.csdnimg.cn/3cf9b388a6fb40ab99dbfeaed4303a30.png)
第二步：对第一步的查询结果(子查询)外面套一层sql，以还款日期作为维度groupby计算每个还款日期后近N天的复借人数
![在这里插入图片描述](https://img-blog.csdnimg.cn/735e19626c8e4107982c14c21965226e.png)
第三步：在第一步和第二步的计算结果上再外面嵌套一层sql，计算复借率
![在这里插入图片描述](https://img-blog.csdnimg.cn/853d2bc888bd454dafa3b3a2bf53849f.png)
sql开发的报表结果：
![在这里插入图片描述](https://img-blog.csdnimg.cn/53ecf4820680463980fded4f58685ece.png)